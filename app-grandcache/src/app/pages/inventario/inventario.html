<div class="container fade-in mt-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="fw-bold text-dark mb-0">Inventario General</h2>
      <p class="text-muted small">Vista global de existencias</p>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-outline-primary" (click)="cargarInventario()">
        <i class="bi bi-arrow-clockwise me-1"></i>Actualizar
      </button>
      <button class="btn btn-primary" routerLink="/administracion/nuevo-producto">
        <i class="bi bi-plus-lg me-1"></i>Nuevo Producto
      </button>
    </div>
  </div>

  @if (cargando()) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2 text-muted">Cargando catálogo...</p>
    </div>
  }

  @if (!cargando() && productos().length > 0) {
    <div class="card shadow-sm border-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">

          <thead class="bg-light text-secondary small text-uppercase">
            <tr>
              <th class="ps-4 py-3">ID</th>
              <th class="py-3">Producto</th>
              <th>Categoría</th>
              <th>Proveedor</th>
              <th>Precio</th>
              <th>Stock</th>
              <th class="text-end pe-4">Acciones</th>
            </tr>
          </thead>

          <tbody>
            @for (prod of productos(); track prod.id) {
              <tr>

                <td class="ps-4 fw-bold text-muted">
                  #{{ prod.id }}
                </td>

                <td> <div class="d-flex align-items-center">
                    <div class="bg-light rounded p-2 me-3 text-primary d-flex align-items-center justify-content-center"
                         style="width: 40px; height: 40px;">
                      <i class="bi bi-box-seam"></i>
                    </div>
                    <div>
                      <div class="fw-bold text-dark">{{ prod.nombre }}</div>
                      <div class="small text-muted">{{ prod.descripcion }}</div>
                    </div>
                  </div>
                </td>

                <td>
                  <span class="badge bg-secondary bg-opacity-10 text-secondary border border-secondary border-opacity-10 rounded-pill">
                    {{ prod.nombre_categoria || 'Sin Cat.' }}
                  </span>
                </td>

                <td class="small text-muted">
                  <i class="bi bi-truck me-1"></i>
                  {{ prod.nombre_proveedor || 'N/A' }}
                </td>

                <td class="fw-bold text-success">
                  ${{ prod.precio }}
                </td>

                <td>
                  @if (prod.stock <= prod.stock_min) {
                    <span class="badge bg-danger bg-opacity-10 text-danger border border-danger border-opacity-10">
                      Critico: {{ prod.stock }}
                    </span>
                  } @else {
                    <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-10">
                      {{ prod.stock }} Uds.
                    </span>
                  }
                </td>

                <td class="text-end pe-4">
                  <button class="btn btn-sm btn-light text-muted me-1" [routerLink]="['/administracion/nuevo-producto']"
                    [queryParams]="{ id: prod.id }" title="Editar Producto">
                    <i class="bi bi-eye"></i>
                  </button>
                  <button class="btn btn-sm btn-light text-muted me-1" [routerLink]="['/administracion/movimientos']"
                    title="Agregar Movimiento">
                    <i class="bi bi-arrow-left-right"></i>
                  </button>

                </td>

              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  } @else if (!cargando()) {
    <div class="alert alert-info text-center">
      No hay productos registrados aún. Ve a "Creación" para agregar uno.
    </div>
  }
</div>
